<!DOCTYPE html>
<html>
<head>
<title>萌多多私宠会馆 - 在线下单 - 5公里送货上门</title>
<!-- for-mobile-apps -->
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<script type="application/x-javascript"> addEventListener("load", function() { setTimeout(hideURLbar, 0); }, false);
		function hideURLbar(){ window.scrollTo(0,1); } </script>
<!-- //for-mobile-apps -->
<link href="css/bootstrap.css" rel="stylesheet" type="text/css" media="all" />
<link href="css/style.css" rel="stylesheet" type="text/css" media="all" />
<!-- js -->
<script src="js/jquery-1.11.1.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js"  crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" crossorigin="anonymous"></script>
<!-- //js -->
<!-- start-smoth-scrolling -->
<script type="text/javascript" src="js/move-top.js"></script>
<script type="text/javascript" src="js/easing.js"></script>
<script type="text/javascript">
	jQuery(document).ready(function($) {
		$(".scroll").click(function(event){		
			event.preventDefault();
			$('html,body').animate({scrollTop:$(this.hash).offset().top},1000);
		});
	});
</script>
<!-- start-smoth-scrolling -->
<!-- start menu -->
<link href="css/megamenu.css" rel="stylesheet" type="text/css" media="all" />
<script type="text/javascript" src="js/megamenu.js"></script>
<script>$(document).ready(function(){$(".megamenu").megamenu();});</script>
<script src="js/menu_jquery.js"></script>
<script src="js/simpleCart.min.js"> </script>
	<style>
	img{
		max-width: 100%;
	}
</style>
</head>
<body>
<!-- header -->
<!-- //header -->

<!-- //header -->
<!-- top-header -->
<script>show_top_header();</script>
<!---->
<!-- single-page -->
<div class="single" style="padding:0px;">
<div class="container">
	<div class="single-page">					 
		<div class="flexslider details-lft-inf">
			<ul class="slides" style="height:279px">
				<img id="pass_img" src="images/1569.gif" style="height:100%;width:100%;"/>
				<!--li data-thumb="images/1569.jpg" id="thumber1"></li-->
			</ul>
		</div>
			<!-- FlexSlider -->
			  <script defer src="js/jquery.flexslider.js"></script>
			<link rel="stylesheet" href="css/flexslider.css" type="text/css" media="screen" />
		<div class="details-left-info">
			<div class="simpleCart_shelfItem">
				<h3 id="product_name" class="item_name" style="font-size: 1.5em;">金卡立减！</h3>
				<h4 id="product_half_name"> </h4>
				<p><h2><span class="item_price qwe" style="font-size: 1.2em;">￥ ******</span></h2> <a href="#" style="font-size: 1.2em;" id="secondDescriptor">Pretium 精选价</a></p>
				<div id="specbox">
					<div class="col-rad tyy">
						<div class="col-rad-left">
							<p>配送方式</p>
						</div>
						<div class="col-rad-right">
							<section>
								<div class="row">
									<div class="colr ert">
										<label class="radio"><input type="radio" name="radio1" checked=""><i></i>5公里送货上门/其他地区快递</label>
									</div>
								</div>
							</section>
						</div>
						<div class="clearfix"> </div>
					</div>
				</div>
				<p class="qty">数量 ：</p><input min="1" type="number" id="quantity" name="quantity" value="1" class="form-control input-small">
				<a class="order" onclick="addToCart(this)" style="margin-bottom:0;width :90%;color:#fff;font-size:1em;padding:0.6em;max-width:600px">添加至购物车</a><br>
				<a class="order" href="checkout.html" style="margin-top:0;width:90%;color:#BC1C62;background:#ECD012;font-size:1em;padding:0.6em;max-width:600px">去购物车结算</a>
				<div class="single-but item_adder" style="width:70%;">
					
				</div>
			</div>
			<div class="flower-type">
				<p>商品类型  ：<a href="#">风干狗粮</a></p>
				<p>产品规格  ：标准包装 <a href="#" id="weightIndicator" style="display: none">*****g</a></p>
				<p>适合体质 ：<a href="#">不限</a></p>
			</div>
			<p class="desc">此产品承诺不满意全额退款</p>
		</div>
		<div class="clearfix"></div>				 	
	</div>
	
<!-- collapse -->
<div class="panel-group collpse" id="accordion" role="tablist" aria-multiselectable="true">
  <div class="panel panel-default">
    <div class="panel-heading" role="tab" id="headingOne">
      <h4 class="panel-title">
        <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
          商品介绍
        </a>
      </h4>
    </div>
    <div id="collapseOne" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingOne">
      <div class="panel-body" id="product_intro">
        <div class="col-12">
		    <img alt="发货介绍" src="images/notice1.jpg" />
			<img alt="发货介绍" src="images/notice2.jpg" />
		  </div>
      </div>
    </div>
  </div>
  <div class="panel panel-default">
    <div class="panel-heading" role="tab" id="headingTwo">
      <h4 class="panel-title">
        <a class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
           附加信息
        </a>
      </h4>
    </div>
    <div id="collapseTwo" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingTwo">
      <div class="panel-body">
      </div>
    </div>
  </div>
  <div class="panel panel-default">
    <div class="panel-heading" role="tab" id="headingThree">
      <h4 class="panel-title">
        <a class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseThree" aria-expanded="true" aria-controls="collapseThree">
          客户反馈
        </a>
      </h4>
    </div>
    <div id="collapseThree" class="panel-collapse" role="tabpanel" aria-labelledby="headingThree">
      <div class="panel-body">
        158****2316：商家送货还是真的快
        <br>176****1891：不知道好不好，先试试看吧，包装不错。
      </div>
    </div>
  </div>
</div>
<!-- collapse -->
<!-- related products -->
	<div class="related-products">
		<h3>相关的产品</h3>
		<div class="col-md-4 related products-grid">
			<a href="single.html?id=3">
			<img src="images/jirougan.jpg" alt=" " class="img-responsive" />
			<div class="simpleCart_shelfItem rel">
				<p><span class="overline"><span id="npricetag_2"></span>18.8元</span> <span class="item_price val"><span id="pricetag_2"></span>12.8元</span></p>
			</div>
			</a>
		</div>
		<div class="col-md-4 related products-grid">
			<a href="single.html?id=5">
			<img src="images/zishumoya.jpg" alt=" " class="img-responsive" />
			<div class="simpleCart_shelfItem rel">
				<p><span class="overline"><span id="npricetag_3"></span>18.8元</span> <span class="item_price val"><span id="pricetag_3"></span>11元</span></p>
			</div>
			</a>
		</div>
		<div class="col-md-4 related products-grid">
			<a href="single.html?id=6">
			<img src="images/yaxiong.jpg" alt=" " class="img-responsive" />
			<div class="simpleCart_shelfItem rel">
				<p><span class="overline"><span id="npricetag_4"></span>16.8元</span> <span class="item_price val"><span id="pricetag_4"></span>12.8元</span></p>
			</div>
			</a>
		</div>
		<div class="clearfix"> </div>
	</div>
<!-- //related products -->
</div>
</div>
<!-- single -->
	<script>
		var product_specs = {};
		var productid = GetQueryString("id");
		if(parseInt(productid) <= 0){
			productid = "1";
		}						

		var product_obj = null;
		shangpin(productid);
		
		function addToCart(){
			if(product_obj == null){
				return;
			}
			var specs = getSpecs();		
			if(specs == null){
				alert("请选择规格");
				return;
			}
			var tempPrice = product_obj.price;
			if(product_obj.tgtPrice != undefined){
				tempPrice = product_obj.tgtPrice;
			}
			var now = simpleCart.add(
				{ 
					name: product_obj.name , 
					price: tempPrice,
					img:product_obj.img, 
					id : productid, 
					spec : specs,
					subtotal: tempPrice,
					quantity: $("#quantity").val()
				});
			if(now !=null)alert("添加成功！");
		}

		function shangpin(productid){
			var a = "/api/commodity?action=find_good&commodity="+ productid;
			$.ajax(
				{ url:a }
			).fail(
				function(obj,n){
					// 失败时执行
					//lert("失败了");
					console.log("失败了："+obj+n);
				}
			).done(
				function(obj,n){
					// 成功时执行
					console.log(obj);
					var c = JSON.parse(obj);
					if(c.code == 1000){
						// c.
						var specstr = c.spec;
						if(typeof(specstr) == "string" && specstr.length > 1){
							c.spec = JSON.parse(specstr);
							showSpecs(c.spec);
						}
						product_obj = c;
						$(".item_name").html(c.name);
						$("#product_half_name").html(c.keywords);
						$(".qwe").html("￥ " + c.price);
						$("#secondDescriptor").html("<span style='text-decoration: line-through; color:#aaa'> 原价: "+c.marketprice+" </span> "+c.content);
						if(c.description == null || c.description == undefined){
							$("#product_intro").html("专业营养师打造，高端宠物食品，立即订购！");
						}else{
							$("#product_intro").html(c.description);	
						}
						
						$("#pass_img")[0].src=c.img;
						$(".item_id").html(productid);
						$(".item_img").html(c.img);
						$("#weightIndicator").html("最低: "+c.weight+"克");
						// Can also be used with $(document).ready()
						/*$(window).load(function() {
						  /*$('.flexslider').flexslider({
							animation: "slide",
							controlNav: "thumbnails"
						  });* /
						});*/
					}else{
						alert(c.msg);
					}
				}
			);
		}
		
function getSpecs(){
	var specs = [];
	if(product_specs!=undefined && product_specs != null && product_specs.length > 0){
		for(i=0;i<product_specs.length;i++){
			var s = product_specs[i];
			var val = $('#spec-input-'+s.id).val();
			// spec[i] = {n : , id: , vals:[{n:, val:, av:, vp:}]}
			chosen = {};
			for(j=0; j<s.vals.length; j++){
				var sl = s.vals[j];
				if(s.vals[j].val == val){
					chosen = {id: s.id, n: s.n, val: sl.val, valn: sl.n, av: sl.av, vp: sl.vp};
					console.log("selected chosen on id:"+i);
					console.debug(chosen);
				}
			}
			if(chosen.id == undefined){
				var sl = s.vals[0];
				chosen = {id: s.id, n: s.n, val: sl.val, valn: sl.n,  av: sl.av, vp: sl.vp};	
				return null;
				//console.log("default chosen on id:"+i);
				//console.debug(chosen);
			}
			specs.push(chosen);
		}
		
	}
	console.debug(specs);
	return specs;
}

function showSpecs(specarr){
	product_specs = specarr;
	var i,j,s,sl;
	var ty = $("#specbox").html();
	for(i=0;i<specarr.length;i++){
		var s = specarr[i];
		ty += '<div class="col-rad tyy">\n' +
		'\t<div class="col-rad-left">\n' +
		'\t\t<p>'+s.n+'</p>'+
		//'\t\t<select class="somehow-specs arrival">\n' +
		//'\t\t\t<option>'+s.n+'</option>\n' +
		//'\t\t</select>\n' +
		'\t</div>\n' +
		'\t<div class="col-rad-right"> <input class="specs-input" id="spec-input-'+s.id+'" sm-ad="0" sm-vp="1" type="hidden" value="" />\n' +
		'\t\t<section>\n' +
		'<div class="btn-group" data-toggle="buttons">';
		//'\t\t\t<div class="row">\n';
		for(j = 0; j < s.vals.length ; j ++){
			var sl = s.vals[j]; // {n:, val:, av:, vp:}
			ty +=   '<label class="btn btn-primary '+((j == 0)?"":"")+'" onclick="changeSpecradio($(this).find(\'input\'))">'+
					' <input type="radio" autocomplete="off" name="option-spec-'+s.id+'" sm-ad="'+sl.av+'" sm-vp="'+sl.vp+'" sm-id="'+s.id+'" sm-val="'+sl.val+'" onclick="changeSpecradio(this)" '+((j == 0)?"checked":"")+'>'+ sl.n +	'</label>';
			/*ty += '<div class="colr ert col-4">\n' +
			'\t<label class="radio"><input type="radio" name='+s.id+' value="'+sl.val+'"><i></i>'+sl.n+'</label>\n' +
			'</div>\n' ;*/
		}
		ty += '\t\t\t</div>\t\t\n' +
		'\t\t</section>\n' +
		'\t</div>\n' +
		'\t<div class="clearfix"> </div>\n' +
		'</div>'
	}
	$("#specbox").html(ty);
}

function changeSpecradio(item){
	var totalAd = 0, totalVp = 1;
	var spec = $(item).attr("sm-val");
	var specId = $(item).attr("sm-id");
	var smad = $(item).attr("sm-ad");
	var smvp = $(item).attr("sm-vp");
	$("#spec-input-"+specId).attr("sm-ad",smad);
	$("#spec-input-"+specId).attr("sm-vp",smvp);
	$(".specs-input").each(function(i,item){
		totalAd += parseFloat($(item).attr("sm-ad"));
		totalVp *= parseFloat($(item).attr("sm-vp"));	
	})
	var targetPrice = (product_obj.price + totalAd) * totalVp
	jQuery(".qwe").html("￥ " + targetPrice);
	product_obj.tgtPrice = targetPrice;
	$('#spec-input-'+specId).val(spec);
	//$(item).button('toggle');
}
</script>
<!-- footer -->
<script>smart_showfooter();</script>
<!-- //footer -->
</body>
</html>